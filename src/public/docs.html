<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Documentación API - Grafos y Rutas</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4f8;
      color: #333;
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    h1 {
      color: #007acc;
      margin-bottom: 1rem;
    }

    h2 {
      margin-top: 2rem;
      margin-bottom: 0.8rem;
      width: 100%;
      text-align: center;
    }

    h3 {
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
      width: 100%;
      max-width: 700px;
    }

    section {
      max-width: 47.5%;
      width: 100%;
      background: white;
      padding: 1.2rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
      margin-bottom: 1.5rem;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    pre {
      background: #e3e8f0;
      border-radius: 5px;
      padding: 1rem;
      overflow-x: auto;
      font-family: Consolas, monospace;
      font-size: 0.95rem;
      position: relative;
      margin-bottom: 1rem;
      color: #1e293b;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    button.copy-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.6rem;
      background: #007acc;
      border: none;
      color: white;
      padding: 0.25rem 0.6rem;
      font-size: 0.8rem;
      border-radius: 5px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s ease;
    }
    button.copy-btn:hover {
      background: #005fa3;
    }

    .output-box {
      background: #f9fafb;
      border-left: 4px solid #007acc;
      padding: 1rem;
      border-radius: 5px;
      white-space: pre-wrap;
      color: #334155;
      font-family: monospace;
      font-size: 0.95rem;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    a {
      color: #007acc;
      text-decoration: none;
      font-weight: 600;
      border-bottom: 2px solid transparent;
      transition: border-color 0.3s;
      display: inline-block;
      margin-top: 1rem;
      font-size: 1rem;
    }
    a:hover {
      border-color: #007acc;
    }

    /* Modo oscuro */
    body.dark-mode {
      background: #121212;
      color: #cbd5e1;
    }

    body.dark-mode h1 {
      color: #66aaff;
    }

    body.dark-mode h2 {
      color: white;
    }

    body.dark-mode h3 {
      color: white;
    }

    body.dark-mode section {
      background: #181818;
    }

    body.dark-mode pre {
      background: #212121;
      color: #cbd5e1;
      scrollbar-color: #6a6b6d #212121;
    }

    body.dark-mode .output-box {
      background: #101010;
      border-left-color: #3b82f6;
      color: #cbd5e1;
    }

    body.dark-mode button.copy-btn {
      background: #3b82f6;
    }

    body.dark-mode button.copy-btn:hover {
      background: #2563eb;
    }

    body.dark-mode a {
      color: #3b82f6;
      border-bottom-color: transparent;
    }
    body.dark-mode a:hover {
      border-bottom-color: #3b82f6;
    }

    /* Botón toggle tema */
    #themeToggle {
      background: transparent;
      border: 1px solid #007acc;
      color: #007acc;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 1.5rem;
      font-weight: 600;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
      align-self: flex-end;
      max-width: 700px;
      max-width: 120px;
      text-align: center;
    }
    body.dark-mode #themeToggle {
      border-color: #3b82f6;
      color: #3b82f6;
    }
    #themeToggle:hover {
      background-color: #007acc;
      color: white;
      border-color: #007acc;
    }
    body.dark-mode #themeToggle:hover {
      background-color: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
  </style>
</head>
<body>
  <button id="themeToggle">Modo Oscuro</button>
  <h1>Documentación de API – Grafos y Rutas</h1>

  <section>
    <h2>Peticiones Backend</h2>

    <h3>Generar grafo de un estado (singular)</h3>
    <pre><code id="grafo-estado1">http://graphs-and-routes.onrender.com/api/grafo?estado=zacatecas</code><button class="copy-btn" onclick="copy('grafo-estado1')">Copiar</button></pre>
    <pre><code id="grafo-estado2">http://localhost:3000/api/grafo?estado=zacatecas</code><button class="copy-btn" onclick="copy('grafo-estado2')">Copiar</button></pre>
    <div class="output-box">
      #meramente ilustrativo,
      {
        "nodos": [ ... ],
        "aristas": [ ... ]
      }
    </div>

    <h3>Generar grafo de varios estados (múltiples)</h3>
    <pre><code id="grafo-multiple1">http://graphs-and-routes.onrender.com/api/grafo?estado=durango&estado=sinaloa&estado=zacatecas</code><button class="copy-btn" onclick="copy('grafo-multiple1')">Copiar</button></pre>
    <pre><code id="grafo-multiple2">http://localhost:3000/api/grafo?estado=durango&estado=sinaloa&estado=zacatecas</code><button class="copy-btn" onclick="copy('grafo-multiple2')">Copiar</button></pre>
    <div class="output-box">WIP</div>

    <h3>Generar grafo de todos los registros (nacional)</h3>
    <pre><code id="grafo-todos1">http://graphs-and-routes.onrender.com/api/grafo</code><button class="copy-btn" onclick="copy('grafo-todos1')">Copiar</button></pre>
    <pre><code id="grafo-todos2">http://localhost:3000/api/grafo</code><button class="copy-btn" onclick="copy('grafo-todos2')">Copiar</button></pre>
    <div class="output-box">WIP</div>

    <h3>Generar ruta entre dos nodos</h3>
    <pre><code id="ruta-nodos">http:/graphs-and-routes.onrender.com/api/ruta?origen=62&destino=72</code><button class="copy-btn" onclick="copy('ruta-nodos')">Copiar</button></pre>
    <div class="output-box">{
      "ruta": [ 62, 16, 17, 2, 80, 72 ],
      "distanciaTotal": 557.1850000000001
    }</div>
  </section>

  <section>
    <h2>Peticiones Frontend (Visualización)</h2>

    <h3>Visualizar ruta entre dos nodos en mapa</h3>
    <pre><code id="vis-ruta1">http://graphs-and-routes.onrender.com/api/visualizadorRuta?archivo=62_72.json</code><button class="copy-btn" onclick="copy('vis-ruta1')">Copiar</button></pre>
    <pre><code id="vis-ruta2">http://localhost:3000/api/visualizadorRuta?archivo=62_72.json</code><button class="copy-btn" onclick="copy('vis-ruta2')">Copiar</button></pre>
    <div class="output-box">
      <center>
        <img src="/img/ruta.png" alt="Ruta">
      </center>
    </div>

    <h3>Visualizar grafo en mapa</h3>
    <pre><code id="vis-grafo1">https://graphs-and-routes.onrender.com/api/visualizador</code><button class="copy-btn" onclick="copy('vis-grafo1')">Copiar</button></pre>
    <pre><code id="vis-grafo2">http://localhost:3000/api/visualizador</code><button class="copy-btn" onclick="copy('vis-grafo2')">Copiar</button></pre>
    <div class="output-box">WIP</div>
  </section>

  <script>
    function copy(id) {
      const code = document.getElementById(id).textContent;
      navigator.clipboard.writeText(code).then(() => {
        alert("Copiado al portapapeles");
      });
    }

    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    let userOverride = false;

    function updateToggleText() {
      themeToggle.textContent = body.classList.contains('dark-mode') ? 'Modo Claro' : 'Modo Oscuro';
    }

    // Init theme on page load
    (function initTheme() {
      try {
        const saved = localStorage.getItem('debug_theme');
        if (saved === 'dark-mode') {
          body.classList.add('dark-mode');
        } else if (saved === 'light') {
          body.classList.remove('dark-mode');
        } else {
          // No saved preference, apply system preference
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            body.classList.add('dark-mode');
          } else {
            body.classList.remove('dark-mode');
          }
        }
      } catch {
        // ignore localStorage errors
      }
      updateToggleText();
    })();

    // Toggle button click handler
    themeToggle.addEventListener('click', () => {
      userOverride = true;
      if (body.classList.contains('dark-mode')) {
        body.classList.remove('dark-mode');
        localStorage.setItem('debug_theme', 'light');
      } else {
        body.classList.add('dark-mode');
        localStorage.setItem('debug_theme', 'dark-mode');
      }
      updateToggleText();
    });

    // Listen to system theme changes
    if (window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
        if (!userOverride) {
          if (e.matches) {
            body.classList.add('dark-mode');
          } else {
            body.classList.remove('dark-mode');
          }
          updateToggleText();
        }
      });
    }

  </script>
</body>
</html>
